{"version":3,"file":"vue.js","sources":["../utils.js","../src/observer/index.js","../src/state.js","../src/init.js","../src/index.js"],"sourcesContent":["export function isFunction(data){\r\n    return typeof data === 'function'\r\n}\r\n\r\nexport function isObject(data){\r\n    return typeof data === 'object' && data !== null\r\n}","import { isObject } from \"../../utils\";\r\n\r\nclass Observer{\r\n    constructor(data){ //对对象所有属性进行劫持\r\n        this.walk(data)\r\n\r\n    }\r\n    walk(data){\r\n        //Object.keys保证是对对象的私有属性进行遍历\r\n        Object.keys(data).forEach(key=>{\r\n            defineReactive(data,key,data[key])\r\n        })\r\n    }\r\n}\r\n\r\n//Vue2会对对象进行遍历一次，为每个属性添加set/get方法，所以性能会差一点\r\nfunction defineReactive(data,key,value){\r\n    //value有可能是对象，进行递归，为value下面的属性添加set/get方法（所以性能会比较差）\r\n    observe(value)\r\n    Object.defineProperty(data,key,{\r\n        get(){\r\n            return value\r\n        },\r\n        set(newValue){\r\n            observe(newValue) //如果用户赋值一个新对象，需要对这个新对象进行劫持\r\n            value = newValue\r\n        }\r\n    })\r\n\r\n}\r\n\r\nexport function observe(data){\r\n    //是对象才进行观测\r\n    if(!isObject(data)){\r\n         return \r\n    }\r\n    return new Observer(data)\r\n}","import { isFunction } from \"../utils\"\r\nimport { observe } from \"./observer/index.js\"\r\nexport function initState(vm){\r\n    const opts = vm.$options\r\n    if(opts.data){\r\n        initData(vm)\r\n    }\r\n    // if(opts.computed){\r\n    //     initComputed()\r\n    // }\r\n    // if(opts.watch){\r\n    //     initWatch()\r\n    // }\r\n    // if(opts.props){\r\n    //     initProps()\r\n    // }\r\n}\r\n\r\nfunction proxy(vm,source,key){\r\n    Object.defineProperty(vm,key,{\r\n        get(){\r\n            return vm[source][key]\r\n        },\r\n        set(newValue){\r\n            vm[source][key] = newValue\r\n        }\r\n    })\r\n}\r\n\r\nfunction initData(vm){\r\n    let data = vm.$options.data\r\n    //判断data是否是函数，如果是函数就通过call调用 this指向vm\r\n    //这时候data与vm没有关系，所以添加vm._data，通过_data进行关联\r\n    data = vm._data = isFunction(data)?data.call(vm):data\r\n\r\n    for(let key in data){ //设置代理，直接通过vm.xxx访问而不是通过vm._data.xxx访问\r\n        proxy(vm,'_data',key)\r\n    }\r\n   //通过Object.defineProperty进行数据劫持\r\n    observe(data)\r\n}","import { initState } from \"./state\"\r\nexport function initMixin(Vue){  //表示在Vue的基础上做一次混合操作\r\n\r\n    Vue.prototype._init= function(options){ //Vue原型上添加_init方法\r\n        const vm= this\r\n        vm.$options = options //后续对options进行扩展操作\r\n\r\n        //对数据进行初始化 watch computed props data ... initState专门对状态进行初始化\r\n        initState(vm)\r\n    }\r\n}","import {initMixin} from './init.js'\r\n\r\nfunction Vue(options){\r\n\r\n    //options是用户传入的配置项,_表示的是Vue内部调用，希望用户不要调用\r\n    this._init(options)\r\n}\r\n\r\ninitMixin(Vue)\r\n\r\n\r\n\r\nexport default Vue"],"names":["isFunction","data","isObject","Observer","walk","Object","keys","forEach","key","defineReactive","value","observe","defineProperty","get","set","newValue","initState","vm","opts","$options","initData","proxy","source","_data","call","initMixin","Vue","prototype","_init","options"],"mappings":"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"}